# 微信小程序

## 1.准备工作

工具：微信小程序开发工具

## 2.项目架构

### app.js

app.js 是小程序的脚本代码。可以用来监听并处理小程序的**生命周期函数**、**声明全局变量**、调用框架提供的**API**。

*生命周期函数*：在**某个时刻**会**自动**执行的函数。

onClick函数在点击的时候被执行（**手动**执行）

[微信API文档](https://developers.weixin.qq.com/miniprogram/dev/api/)

全局变量数据：**globalData**

关键字**this**：代表类本身的对象。

### app.json

app.json是对整个小程序的全局配置，可以用来配置小程序由哪些页面组成，配置小程序的**窗口背景色**，配置**导航条样式**，配置默认**标题**，**不可以添加任何注释**。

包含两部分：pages和windows。

pages是指整个小程序包含的页面，可以根据相对路径查找到对应的页面；windows是设置一些窗口样式。

```
"pages": [
    "pages/index/index"
  ],
```

```
"window": {
    "navigationBarBackgroundColor": "#ff715c", //窗口背景色
    "navigationBarTextStyle": "black", //字体颜色
    "navigationBarTitleText": "小橙序", //标题
    "backgroundColor": "#eeeeee", 
    "backgroundTextStyle": "light", 
    "enablePullDownRefresh": false
  },
```

### app.wxss

app.wxss是整个小程序的**公共样式表**。

## 3.页面的构成

 ### index.js

index.js 是页面数据的存储，网络请求的加载都在这里。

```
// pages/addPage/addPage.js
Page({ 
	/**
	* 页面的初始数据 *
	/ data: {
	
    },
    /**
    * 生命周期函数--监听页面加载 
    */ 
    onLoad: function (options) { 
    console.debug("onLoad--监听页面加载"); 
    }, 
    /**
    * 生命周期函数--监听页面初次渲染完成 
    */ 
    onReady: function () {
    console.debug("onReady--监听页面初次渲染完成"); 
    }, 
    /**
    * 生命周期函数--监听页面显示
    */ 
    onShow: function () { 
    console.debug("onShow--监听页面显示");
    }, 
    /** 
    * 生命周期函数--监听页面隐藏
    */ 
    onHide: function () {
    console.debug("onHide--监听页面隐藏");
    }, 
    /**
    * 生命周期函数--监听页面卸载 
    */
    onUnload: function () { 
    console.debug("onUnload--监听页面卸载");
    }, 
    /** 
    * 页面相关事件处理函数--监听用户下拉动作
    */ 
    onPullDownRefresh: function () { 
    console.debug("onPullDownRefresh--监听用户下拉动作"); 
    }, 
    /**
    * 页面上拉触底事件的处理函数 
    */ 
    onReachBottom: function () { 
    console.debug("onReachBottom--页面上拉触底事件的处理函数"); 
    },
    /**
    * 用户点击右上角分享
    */ 
    onShareAppMessage: function () { 		      console.debug("onShareAppMessage--用户点击右上角分享"); 
    } 
    })
```



### index.json

index.json 用来设置导航栏样式，和app.json性质一样，如果没有设置样式，就默认用app.json中的样式。

### index.wxml

index.wxml  用来设置展现给用户的界面。

### index.wxss

index.wxss 页面样式设计。

## 4.列表渲染

### wx:for

wx:for-item="循环项的名称"

wx:for-index="循环项的索引"

wx:key="唯一的值" ，用来提高列表渲染的性能

```
data:{
	list0:['0','1','2'],
	list1:[{name:'1'},{name:'2'},{name:'3'}],
	list2:[
		[1,2,3]
		[4,5,6]
		[7,8,9]
	],
	dict1:{
	name:'1',
	name1:'2'
	name2:'3'
	}
},
```

```
<text wx:for="{{list0}}">{{item}}</text>

<text wx:for="{{list1}}">{{item.name}}</text>

<text wx:for="{{list2}}">
	<text wx:for={{item}}>
	{{item}}
	</text>
</text>

<text wx:for="{{dict1}}" wx:for-index="key" wx:for-item="value">
{{key}}--{{value}}
</text>
```

## 5.条件渲染

### 1.wx：if

当标签不是频繁地切换显示，优先使用

wx：if=”{{true、false}}“，wx:if,wx:elif,wx:wlse

```
<view wx:if="{{false}}">wx:if</view>
```



### 2.hidden

当标签频繁地切换显示，优先使用

hidden="{{true}}"

```
<view hidden>hidden</view>
```



## 6.导航栏

**底部导航栏**：

```
"tabBar": {
    "list": [{
      "pagePath":"pages/index/index",//页面路径
      "text": "首页"//导航栏名字
      "iconPath": "images/bottomNav/cart.png",// 默认导航栏图片路径（未选中时的图标）
      "selectedIconPath":"images/bottomNav/cart_select.png",//勾选图片的路径（选中时的图标）
    },
    {
      "pagePath":"pages/index/index",
      "text": "地图"
    }
    ]
  },
```

**顶部导航栏：**

级别比较低，是页面级别的导航栏，应该写在页面里。

## 7.页面配置

## 8.常用标签

1.**text** 相当于**span**标签 行内元素 **不会换行**

2.**view**相当于**div**标签 块级元素 **会换行**

## 9.数据绑定

在.js文件中写入数据，可以用两个花括号引用。{{}}

例如：

```
Pge({
data:{
	msg:"hello"
}
})

<view>{{msg}}</view>
```

### {{}}里进行运算

1.表达式：数字的加减，字符串拼接，三元表达式

2.语句：if else，switch，do while，for

## 10.小程序事件的绑定

1.给input标签绑定 input事件

绑定关键字 bindinput

```
<input bindinput="函数名"/>
```

2.如何获取 输入框的值

通过事件源对象来获取

```
e.datail.value
```

3.把输入框的值 赋值到data中

```
函数名（参数）{  //声明函数
this.setData({
	num:e.detail.value
})
}
```

4.加入一个点击事件

关键字 bindtap

**无法**在小程序当中的事件中**直接传参**

需要通过**自定义属性**的方式来传递参数

在事件源中获取自定义属性

```
<button bindtap="handletap"//函数名 data-operation="{{1}}">+</button>
<button bindtap="handletap" data-operation="{{-1}}">+</button>
```

```
handletap(e)//函数名{
const operation = e.currentTarget.dataset.operation;
this.setData({
num:this.data.num+operation
})
}
```

## 11.swiper

swiper：滑块视图容器

swiper-item：滑块

[微信开放文件](https://developers.weixin.qq.com/miniprogram/dev/component/swiper.html)

```
<swiper autoplay interval="2000" indicator-dots="true" indicator-active-color="#B22222" circular="true">
<swiper-item><image src="/static/images/t2.jpg/"/></swiper-item>
<swiper-item><image src="/static/images/logo.png/"/></swiper-item>
<swiper-item><image src="/static/images/949.jpg/"/></swiper-item>
</swiper>
```

## 12.navigator导航组件

类似**超链接**标签，是块级元素，可以直接加宽度和高度。

### url

要跳转的页面路径（绝对路径/相对路径）

```
<navigator url="/pages/demo03/demo03"> 滑块 </navigator>
```

### target

self：默认值  跳转到自己小程序的页面

miniProgram：跳转到其他小程序的页面

### open-type

1.navigate 默认值 保留当前页面，跳转到应用内的某个页面，但是**不能跳到tabbar页面**。

2.redirect 关闭当前页面，跳转到应用内的某个页面，但是**不能跳到tabbar页面**。

3.switchTab 跳转到tabBar页面，并关闭其他所有非tabBar页面。

[微信开放文件](https://developers.weixin.qq.com/miniprogram/dev/component/navigator.html)

## 13.rich-text 富文本标签?

可以将字符串解析成对应标签

### nodes属性

```
<rich-text nodes="{{html}}"></rich-text>
```

## 14.button

[微信开放文件](https://developers.weixin.qq.com/miniprogram/dev/component/button.html)

```
<button>按钮</button>
```

**获取用户手机号码**

```
<button open-type="getPhoneNumber" bindgetphone="getPhoneNumber">getPhoneNumber</button>
```

```
getPhoneNumber(e){ //在.js页声明函数
console.log(e);
}
```

## 15.生命周期函数

概念：在某个时刻会自动执行的函数。

